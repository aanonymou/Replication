# Drebin:
## To extract the features, use ``GetApkData.py`` script:
This script generates ".data" files that represents the features extracted from the APK files.

INPUTs are: The path to the APK files directory and optionally the number of CPUs to use. 
            They are explained in details in the script.
OUTPUTs are the ".data" file that has the list of the extracted features and the manifest file.

Example: 

```python GetApkData.py -d /Replication/dataset/```

## To embedd the features and perform the classification, use ``classification_drebin.py`` script:
This script embedd the features extracted with `GetApkData.py` in vectors space and it performs 
the classification using SVM LinearSVC classifier.
Recall and Accuracy are calculated 10 times. Each experiment is performed with 66% of training 
set and 33% of test set, and scores are averaged.
Roc curve is plotted using the last trained classifier from the 10 experiments.

### INPUTs are: 
    - The path to the .data malware files directory, 
    - The path to the .data goodware files directory, 
    - The name of the txt file on which the results will be written, 
    - The name of the pdf file on which the roc curve will be saved, 
    - and optionally, The seed to fix for the experiments. 
### OUTPUTs are: 
    - the results text file,
    - and roc curve pdf graph.
Example: 

```python classification_drebin.py -md /Replication/dataset/malware/ -gd /Replication/dataset/goodware/ -fs file_scores -roc file_roc```

# MaMaDoid:
## To extract the features, use `mamadroid.py` script:
This script is used to generate the call graphs.

### INPUTs are: 
    - The path to the APK files directory, 
    - and the path to the Android platform directory
### OUTPUTs are:
    - 4 directories created inside the provided APK files directory. They are: 
        - "graphs" (it contains the call graphs), 
        - "family", 
        - "package",
        - "class" directories (they contain the abstarction of the call graphs to family, package, and class modes respectively).

Example: 

```python mamadroid.py -f /Replication/dataset/ -d /Replication/mamadroid/android/```

## To embedd the features, use `MaMaStat.py` script:
This script creates the features files for family and package modes.

### INPUTs are: 
    - The names of the call graphs datasets in this format (database1:database2:database3). 
              You need to move the call graphs generated with `mamadroid.py` script, to "graphs" 
              directory that is in the same directory as `mamadroid.py` and `MaMaStat.py` scripts,
    - Flag to write intermediate files or not.
              INPUTs are explained in more details in the script.

### OUTPUTs are: 
    - The features files (one per indicated database) that are created as "name_of_the_database".csv files in the folders Features/Families and Features/Packages
Example: 

```python MaMaStat.py -d Trial1 -wf N```

To perform the classification, use `classification_mamadroid.py` script: 
This script performs MaMaDroid's classification using Random Forest classifier.
Scores (Precision, Recall, F1-score) are calculated using 10-folds cross-validation with and without 
PCA for family and package modes. 

### INPUTs are: 
    - The path to the CSV features files of family mode, for drebin, 2013, 2014, 2015, 2016, 
             oldbenign, and newbenign datasets. These files are generated by `MaMaStat.py` script 
             in Features/Families,
    - The path to the CSV features files of package mode, for drebin, 2013, 2014, 2015, 2016, 
             oldbenign, and newbenign datasets. These files are generated by `MaMaStat.py` script 
             in Features/Packages.
    - The name of the txt file on which the results will be written, 
    - and optionally, the seed to fix for the experiments. 


### OUTPUTs are:
    - The results text file.

Example: 

```python classification_mamadroid.py -pf Features/Families -pp Features/Packages -fs file_scores```

# Datasets:
## Drebin:
- Malware:
    - They are provided by original authors.
    - Drebin_Malware_APK_Done.txt: List of hashes of APKs that passed the features extraction.
    - Drebin_Malware_APK_Errors.txt: List of hashes of APKs that failed in the features extraction.
- Goodware:
    - (They were collected from AndroZoo)
    - Drebin_Goodware_Original_All.txt: List of hashes of Drebin original APKs.
    - Drebin_Goodware_Original_Found.txt: List of hashes of Drebin original APKs that are available in AndroZoo.
    - Drebin_Goodware_Original_NotFound.txt: List of hashes of Drebin original APKs that are not available in AndroZoo.
    - Drebin_Goodware_Original_Failed.txt: List of hashes of Drebin original APKs.
    - Drebin_Goodware_CompleteWith.txt: List of hashes of APKs that are used to complete the dataset.
    - Drebin_Goodware_Orig+Completed.txt: List of hashes of original APKs that passed the features extraction and the APK that used to complete the goodware dataset.

## MaMaDroid:
- Malware:
    - 2013, 2014, 2015, and 2016 are collected from VirusShare. They are also available in AndroZoo
    - drebin is provided by Drebin original authors
    - INPUTs are: The path to the APK files directory and optionally the number of CPUs to use. 
    - 2013_hashes_found.txt: List of hashes of 2013 dataset APKs that we were able to collect.
    - 2013_hashes_done.txt: List of hashes of 2013 dataset APKs that passed the features extraction.
    - 2013_hashes_failed.txt: List of hashes of 2013 dataset APKs that failed in the features extraction.
    - 2014_hashes_found.txt: List of hashes of 2014 dataset APKs that we were able to collect.
    - 2014_hashes_done.txt: List of hashes of 2014 dataset APKs that passed the features extraction.
    - 2014_hashes_failed.txt: List of hashes of 2014 dataset APKs that failed in the features extraction.
    - 2015_hashes_found.txt: List of hashes of 2015 dataset APKs that we were able to collect.
    - 2015_hashes_notFound.txt: List of hashes of 2015 dataset APKs that we were not able to collect.
    - 2015_hashes_done.txt: List of hashes of 2015 dataset APKs that passed the features extraction.
    - 2015_hashes_failed.txt: List of hashes of 2015 dataset APKs that failed in the features extraction.
    - 2016_hashes_found.txt: List of hashes of 2016 dataset APKs that we were able to collect.
    - 2016_hashes_done.txt: List of hashes of 2016 dataset APKs that passed the features extraction.
    - 2016_hashes_failed.txt: List of hashes of 2016 dataset APKs that failed in the features extraction.
    - drebin_hashes_found.txt: List of hashes of drebin dataset APKs that we were able to collect.
    - drebin_hashes_done.txt: List of hashes of drebin dataset APKs that passed the features extraction.
    - drebin_hashes_failed.txt: List of hashes of drebin dataset APKs that failed in the features extraction.

- Goodware:
    - oldbenign dataset is collected from PlayDrone, and it is available in AndroZoo
    - newbenign dataset are collected from AndroZoo.
    - oldbenign_hashes_found.txt: List of hashes of oldbenign dataset APKs that we were able to collect.
    - oldbenign_hashes_done.txt: List of hashes of oldbenign dataset APKs that passed the features extraction.
    - oldbenign_hashes_failed.txt: List of hashes of oldbenign dataset APKs that failed in the features extraction.
    - oldbenign_namesApp_found.txt: List of apps names of oldbenign dataset APKs that we were able to collect.
    - oldbenign_namesApp_done.txt: List of apps names (as provided by PlayDrone) of oldbenign dataset APKs that passed the features extraction.
    - oldbenign_namesApp_failed.txt: List of apps names of oldbenign dataset APKs that failed in the features extraction.
    - newbenign_hashes_found.txt: List of hashes of newbenign dataset APKs that we were able to collect.
    - newbenign_hashes_notFound.txt: List of hashes of newbenign dataset APKs that we were not able to collect.
    - newbenign_hashes_done.txt: List of hashes of newbenign dataset APKs that passed the features extraction.
    - newbenign_hashes_failed.txt: List of hashes of newbenign dataset APKs that failed in the features extraction.
    - newbenign_UsedToComplete.txt: List of hashes of APKs that are used to complete the newbenign original dataset.

# Original Code: 
- Repositories:
    - https://bitbucket.org/gianluca_students/mamadroid_code/
    - https://github.com/MLDroid/drebin


# Seed Values
To try to achieve replicable results, the results presented in our paper were computed after setting the seed values to:  
- MaMaDroid: 
    - 388652140
- Drebin
    - 388652140


